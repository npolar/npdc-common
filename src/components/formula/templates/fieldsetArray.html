<!DOCTYPE html>
<ul>
  <li ng-repeat="value in field.values track by value.path" ng-if="!value.hidden">
    <md-whiteframe class="md-whiteframe-z2">
      <fieldset ng-class="{ valid: value.valid }">
        <legend>
          <!--span class="np-formula-array-object-title">{{ value.title }}</span-->
          <span ng-if="!value.visible">{{ value.fields | formulaInlineValues }}</span>
          <div class="np-formula-object-ctrls">
            <div npdc:formula-field-info class="np-field-info" ng-init="field=value" ng-if="value.description"></div>
            <a class="toggle" href="" ng-click="field.itemToggle($index)" title="{{ value.visible ? form.i18n.minimize[1] : form.i18n.maximize[1] }}">
              <md-icon>{{ value.visible ? 'expand_less' : 'expand_more' }}</md-icon>
            </a>
            <md-menu>
              <md-button aria-label="Remove" class="md-icon-button remove" ng-click="$mdOpenMenu($event)">
                <md-icon md-menu-origin>close</md-icon>
              </md-button>
              <md-menu-content>
                <md-menu-item>
                  <md-button ng-click="field.itemRemove($index)" title="{{ form.i18n.remove[1] }}" class="md-warn">
                    <md-icon md-menu-align-target>delete</md-icon> Remove item
                  </md-button>
                </md-menu-item>
              </md-menu-content>
            </md-menu>
          </div>
        </legend>
        <fieldset formula:field="value" class="np-formula-object" ng-if="field.visible">
          <div ng-repeat="field in ::field.fields track by field.path">
            <formula:field-instance field="field"></formula:field-instance>
          </div>
        </fieldset>
      </fieldset>
    </md-whiteframe>
  </li>
</ul>
