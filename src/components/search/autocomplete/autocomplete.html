<!DOCTYPE html>
<div ng-controller="NpdcAutocompleteController as ctrl">
  <form ng-submit="ctrl.redirectToSearch(ctrl.searchText)">
    <md-autocomplete
      md-item-text="ctrl.title(item)"
      md-items="item in ctrl.querySearch(ctrl.searchText)"
      md-min-length="1"
      md-no-cache="true"
      md-search-text-change="ctrl.searchTextChange(ctrl.searchText)"
      md-search-text="ctrl.searchText"
      md-selected-item-change="ctrl.selectedItemChange(item)"
      md-selected-item="ctrl.selectedItem"
      md-floating-label="{{ctrl.placeholder()}}">

      <md-item-template>
        <span md-highlight-flags="^i" md-highlight-text="ctrl.searchText" ng-if="item">[{{item.collection}}]
          {{ item.name || item.title || item.code || item.titles[0].title || item.id }}</span>
      </md-item-template>

    </md-autocomplete>

    <div ng-if="config.showCollections && !expandSearch">
      <br/>
      <md-checkbox ng-change="ctrl.querySearch(ctrl.searchText)" ng-model="ctrl.collectionSelected[collection]" ng-repeat="collection in ctrl.collections">{{ collection }}</md-checkbox>
    </div>

  </form>
</div>
